# Get All Appointments Service

## DescripciÃ³n
Este microservicio permite obtener todas las citas almacenadas en la base de datos. EstÃ¡ desarrollado en PHP con Slim Framework y utiliza PostgreSQL para almacenar los datos y MySQL para obtener informaciÃ³n adicional de doctores y pacientes.

## InstalaciÃ³n y EjecuciÃ³n

### Requisitos Previos
- Docker instalado
- PostgreSQL y MySQL configurados
- Composer instalado

### ConstrucciÃ³n del Contenedor
```sh
docker build -t get-all-appointments-service .
```

### Ejecutar el Contenedor
```sh
docker run -d --name get-all-appointments-service -p 5005:5005 get-all-appointments-service
```

### Verificar el Contenedor en EjecuciÃ³n
```sh
docker ps
```

## Endpoints

### Obtener todas las citas
**MÃ©todo:** GET

**URL:**
```
http://localhost:5005/get-all-appointments-service/appointments
```

**Respuesta esperada:**
```json
[
  {
    "id": 1,
    "doctor_id": 3,
    "doctor_name": "Dr. Juan PÃ©rez",
    "patient_id": 7,
    "patient_name": "Kevin Macas",
    "appointment_date": "2024-06-15 10:00:00",
    "status": "pending"
  },
  {
    "id": 2,
    "doctor_id": 5,
    "doctor_name": "Dra. Ana GÃ³mez",
    "patient_id": 10,
    "patient_name": "Carlos LÃ³pez",
    "appointment_date": "2024-06-16 14:30:00",
    "status": "confirmed"
  }
]
```

Si no hay citas registradas:
```json
{
  "message": "No hay citas registradas"
}
```

## Estructura del Proyecto

```
ğŸ“ get-all-appointments-service
 â”œâ”€â”€ ğŸ“‚ public
 â”‚   â”œâ”€â”€ index.php
 â”‚
 â”œâ”€â”€ ğŸ“‚ src
 â”‚   â”œâ”€â”€ ğŸ“‚ config
 â”‚   â”‚   â”œâ”€â”€ database.php
 â”‚   â”‚
 â”‚   â”œâ”€â”€ ğŸ“‚ controllers
 â”‚   â”‚   â”œâ”€â”€ GetAllAppointmentsController.php
 â”‚   â”‚
 â”‚   â”œâ”€â”€ ğŸ“‚ models
 â”‚   â”‚   â”œâ”€â”€ Appointment.php
 â”‚
 â”œâ”€â”€ .env
 â”œâ”€â”€ Dockerfile
 â”œâ”€â”€ composer.json
 â”œâ”€â”€ composer.lock
```

## SoluciÃ³n de Problemas

1. **Error: "could not find driver"**
   - AsegÃºrate de que el Dockerfile instala `pdo_mysql` y `pdo_pgsql`.
   - Recompila la imagen:
   ```sh
   docker build --no-cache -t get-all-appointments-service .
   ```

2. **El .env no se carga correctamente**
   - Verifica que `.env` se copie correctamente al contenedor.
   - Comprueba dentro del contenedor:
   ```sh
   docker exec -it get-all-appointments-service cat /var/www/html/.env
   ```

3. **No se encuentra la ruta en Postman (404 Not Found)**
   - Verifica que `index.php` estÃ© configurado correctamente.
   - AsegÃºrate de que el servidor PHP estÃ¡ en ejecuciÃ³n dentro del contenedor.

